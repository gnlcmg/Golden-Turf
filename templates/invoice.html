<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Invoice Form - Golden Turf</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='dashboard.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='invoice.css') }}" />
</head>
<body>
    <div class="sidebar" style="position: fixed; top: 0; left: 0; width: 200px; height: 100%; background-color: #006400; color: white;">
        <div style="width:100%;text-align:center;margin-bottom:20px;">
            <img src="/static/golden_turf_logo.png" alt="Golden Turf Logo" style="width:100px;display:block;margin:0 auto;">
        </div>
        <h2 style="color: orange;">Golden Turf</h2>
        <nav class="navbar">
            <a href="/dashboard" style="color: white; font-size: 16px; text-decoration: none; display: block; padding: 10px;">Dashboard</a>
            <div class="nav-dropdown">
                <a href="#" class="dropbtn" style="color: white; font-size: 16px; text-decoration: none; display: block; padding: 10px;">Products</a>
                <div class="dropdown-content">
                    <a href="{{ url_for('products_list') }}" style="color: white; font-size: 16px; text-decoration: none; display: block; padding: 10px;">Products List</a>
                    <a href="{{ url_for('invoice') }}" style="color: white; font-size: 16px; text-decoration: none; display: block; padding: 10px;">Invoice Form</a>
                    <a href="{{ url_for('clients') }}" style="color: white; font-size: 16px; text-decoration: none; display: block; padding: 10px;">Client Details Form</a>
                </div>
            </div>
            <a href="{{ url_for('quotes') }}" style="color: white; font-size: 16px; text-decoration: none; display: block; padding: 10px;">Quotes</a>
            <a href="{{ url_for('payments') }}" style="color: white; font-size: 16px; text-decoration: none; display: block; padding: 10px;">Payments</a>
            <a href="{{ url_for('calendar') }}" style="color: white; font-size: 16px; text-decoration: none; display: block; padding: 10px;">Calendar</a>
        </nav>
    </div>
    <div class="container" style="margin-left: 220px;">
        <header>
            <h1>Invoice Form</h1>
        </header>

            <form method="POST" action="{{ url_for('invoice') }}">
            <section class="client-info">
                <h2>Client Information</h2>
                <label for="client_name">Client Name:</label>
                <input type="text" id="client_name" name="client_name" value="{{ client_name or '' }}" required />

                <label for="turf_type">Turf Type:</label>
                <select id="turf_type" name="turf_type" required>
                    <option value="none" {% if turf_type == 'none' %}selected{% endif %}>None</option>
                    <option value="Golden Imperial Lush" {% if turf_type == 'Golden Imperial Lush' %}selected{% endif %}>Golden Imperial Lush</option>
                    <option value="Golden Green Lush" {% if turf_type == 'Golden Green Lush' %}selected{% endif %}>Golden Green Lush</option>
                    <option value="Golden Natural 40mm" {% if turf_type == 'Golden Natural 40mm' %}selected{% endif %}>Golden Natural 40mm</option>
                    <option value="Golden Golf Turf" {% if turf_type == 'Golden Golf Turf' %}selected{% endif %}>Golden Golf Turf</option>
                    <option value="Golden Premium Turf" {% if turf_type == 'Golden Premium Turf' %}selected{% endif %}>Golden Premium Turf</option>
                </select>

                <label for="area">Area (sq meters):</label>
                <input type="number" id="area" name="area" min="0.01" step="0.01" value="{{ area or '' }}" required />

                <label for="extra_fee">Extra Fee:</label>
                <input type="number" id="extra_fee" name="extra_fee" min="0" step="0.01" value="{{ extra_fee or 0 }}" />

                <label for="extras">Extras:</label>
                <select id="extras" name="extras">
                    <option value="none" {% if extras == 'none' %}selected{% endif %}>None</option>
                    <option value="artificial_hedges" {% if extras == 'artificial_hedges' %}selected{% endif %}>Artificial Hedges</option>
                    <option value="fountain" {% if extras == 'fountain' %}selected{% endif %}>Fountain</option>
                    <option value="bamboo_products" {% if extras == 'bamboo_products' %}selected{% endif %}>Bamboo Products</option>
                    <option value="polished_pebbles" {% if extras == 'polished_pebbles' %}selected{% endif %}>Polished/Glowing Pebbles</option>
                    <option value="pegs" {% if extras == 'pegs' %}selected{% endif %}>Pegs (U-pins/Nails)</option>
                </select>

                {% set extras_costs = {
                    'none': 0,
                    'artificial_hedges': 50,
                    'fountain': 150,
                    'bamboo_products': 75,
                    'polished_pebbles': 40,
                    'pegs': 20
                } %}

                <label for="payment_status">Payment Status:</label>
                <select id="payment_status" name="payment_status" required>
                    <option value="" disabled selected>Select payment status</option>
                    <option value="Paid" {% if payment_status == 'Paid' %}selected{% endif %}>Paid</option>
                    <option value="Unpaid" {% if payment_status == 'Unpaid' %}selected{% endif %}>Unpaid</option>
                    <option value="Overdue" {% if payment_status == 'Overdue' %}selected{% endif %}>Overdue</option>
                </select>

                <label for="gst">Apply GST (10%):</label>
                <input type="checkbox" id="gst" name="gst" value="yes" {% if gst == 'yes' %}checked{% endif %} />
            </section>

            <div class="form-actions">
                <button type="submit">Submit Invoice</button>
                <button type="button" onclick="window.print()">Print Invoice</button>
            </div>
        </form>

        {% if summary %}
        <div class="invoice-summary">
            <h2>Invoice Summary</h2>
            <p>Client Name: {{ summary.client_name }}</p>
            <p>Turf Type: {{ summary.turf_type }}</p>
            <p>Area: {{ summary.area }} sq m</p>
            <p>Extra Fee: ${{ "%.2f"|format(summary.extra_fee) }}</p>
            <p>GST: ${{ "%.2f"|format(summary.gst) }}</p>
            <p>Total Price: ${{ "%.2f"|format(summary.total_price) }}</p>
        </div>
        {% endif %}
    </div>

    <script>
        const turfTypeSelect = document.getElementById('turf_type');
        const areaInput = document.getElementById('area');

        function toggleAreaRequirement() {
            if (turfTypeSelect.value === 'none') {
                areaInput.value = '';
                areaInput.required = false;
                areaInput.disabled = true;
            } else {
                areaInput.required = true;
                areaInput.disabled = false;
            }
        }

        turfTypeSelect.addEventListener('change', toggleAreaRequirement);

        // Initialize on page load
        toggleAreaRequirement();

        // Update GST calculation to 10%
        const gstRate = 0.10; // 10% GST
    </script>
</body>
</html>
